digraph G {

	graph [ layout = dot rankdir = TB ]

  node [ shape = doublecircle ]
  event_log [ label = "Event log\n(sqlite)" ]
  central_db [ label = "AwareOffice\ndatabase" ]

  node [ shape = box ]
  central_server [ label = "AwareOffice\nweb server" ]
  sensor_server [ label = "Sensor info\nweb server" ]
  reporting_daemon [ label = "Reporting daemon\n(?)" ]
  sensor_daemon [ label = "Sensor daemon\n(python)" ]
  idle_daemon [ label = "Idle daemon\n(?)" ]
  idle_windows [ label = "Windows?" ]
  idle_linux [ label = "X11" ]
  lock_daemon [ label = "Locking daemon\n(?)" ]
  lock_linux [ label = "Gnome screensaver" ]
  lock_windows [ label = "Windows?" ]
  chat_client [ label = "Pidgin" ]
  chat_server [ label = "Chat server" ]
  chat_daemon [ label = "Purple daemon\n(python)" ]
  admin_web [ label = "Web client\n(admin interface)" ]

  node [ shape = trapezium ]
  ir_sensor [ label = "IR\ntemperature\nsensor" ]
  keyboard_mouse [ label = "Keyboard,\nmouse" ]

  ir_sensor -> sensor_daemon -> event_log
  keyboard_mouse -> { idle_linux idle_windows } -> idle_daemon -> event_log
  event_log -> { reporting_daemon sensor_server }
  event_log -> lock_daemon -> { lock_linux lock_windows }
  reporting_daemon -> central_server [ label = "http" ]
  event_log -> chat_daemon -> chat_client -> chat_server
  central_server -> central_db [ dir = both ]
  central_server -> admin_web -> { chat_daemon lock_daemon } [ label = "http" ]

}
